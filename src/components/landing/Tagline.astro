---
import { getLangFromUrl, useTranslations } from "@i18n/utils";

const { class: className } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<div id="smooth-wrapper" class:list={["section tagline-section relative bg-zinc-900 text-white", className]}>
  <div class="tagline-arrows">
    <svg 
      viewBox="0 0 550 330" 
      class="h-[25rem] w-[25rem] md:w-[30rem]"
    >
      <!-- Solo Line Path -->
      <path
        id="tagline-path"
        fill="none"
        stroke="white"
        stroke-width="12"
        opacity="0"
        d="M8.5,7.8C46.3,67,121.7,185.5,265.5,185.9c42.8,0.1,120.5-55.9-25.2-120.3C79-5.8,177.6,164.1,222.3,207.7c59.1,49.9,83.8,62.1,162.6,96.8"
      ></path>
    </svg>
  </div>

  <div class="text col-span-12 flex justify-center font-light">
    <p id="tagline-text" class="max-w-5xl text-center text-4xl md:text-5xl lg:text-7xl">
      <span class="gradient-text">{t("tagline")}</span>
    </p>
  </div>
</div>

<style>
  #tagline-text {
    font-family: "Your Font Here", sans-serif;
    line-height: 1.2;
  }

  .gradient-text {
    background: linear-gradient(to bottom, #ffffff 50%, #666666 50%);
    background-size: 100% 200%;
    background-position-y: 100%;
    color: transparent;
    background-clip: text;
    -webkit-background-clip: text;
  }
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  // Slimmed-down plugin registration
  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    const line = document.querySelector("#tagline-path");

    // Buttery-smooth line animation
    gsap.from("#tagline-text .gradient-text", {
      opacity: 0,
      y: 20,
      duration: 1,
      ease: "power2.out",
      scrollTrigger: {
        trigger: "#tagline-text",
        start: "top 80%",
        end: "bottom 20%",
        toggleActions: "play none none reverse",
      },
    });

    // Enhanced line animation
    const lineAnimation = gsap.timeline({
      scrollTrigger: {
        trigger: ".tagline-arrows",
        start: "top 80%",
        end: "bottom 20%",
        scrub: 1.5, // Smoother scrub
      }
    });

    // Fluid draw animation
    lineAnimation
      .to(line, {
        opacity: 1,
        duration: 0.5
      })
      .to(line, {
        drawSVG: "100%",
        duration: 3,
        ease: "power2.inOut"
      });
  });
</script>
