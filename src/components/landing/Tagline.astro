---
import { getLangFromUrl, useTranslations } from "@i18n/utils";

const { class: className } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<div id="smooth-wrapper" class:list={["section tagline-section relative bg-zinc-900 text-white", className]}>
  <div class="tagline-arrows">
    <svg
      viewBox="0 0 550 330" 
      class="h-[20rem] w-[20rem] md:w-[25rem] lg:w-[30rem]"
    >
      <!-- Animated Line -->
      <path
        id="tagline-path"
        fill="none"
        stroke="white"
        stroke-width="12"
        opacity="0"
        d="M8.5,7.8C46.3,67,121.7,185.5,265.5,185.9c42.8,0.1,120.5-55.9-25.2-120.3C79-5.8,177.6,164.1,222.3,207.7c59.1,49.9,83.8,62.1,162.6,96.8"
      ></path>
    </svg>
  </div>

  <!-- "Our aim?" Text -->
  <div class="our-aim-text absolute inset-0 flex items-center justify-center">
    <p class="text-white text-3xl md:text-4xl lg:text-5xl font-light opacity-0">
      Our aim?
    </p>
  </div>

  <!-- Main Tagline Text -->
  <div class="text col-span-12 flex justify-center font-light">
    <p id="services-tagline" class="max-w-5xl text-center text-4xl md:text-5xl lg:text-7xl">
      <span class="gradient-text">{t("tagline")}</span>
    </p>
  </div>
</div>

<style>
  /* Keep existing gradient styles */
  .gradient-text {
    background: linear-gradient(to bottom, #ffffff 50%, #666666 50%);
    background-size: 100% 200%;
    background-position-y: 100%;
    color: transparent;
    background-clip: text;
    -webkit-background-clip: text;
  }
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    const line = document.querySelector("#tagline-path");
    const aimText = document.querySelector(".our-aim-text p");

    // Initial setup
    gsap.set([line, aimText], { opacity: 0 });
    gsap.set(line, { drawSVG: "0%" });

    // Unified timeline
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: ".tagline-section",
        start: "top 80%",
        end: "bottom 20%",
        scrub: 1,
      }
    });

    // Line animation
    tl.to(line, {
      drawSVG: "100%",
      opacity: 1,
      duration: 2
    });

    // "Our aim?" text animation (sync with line)
    tl.to(aimText, {
      opacity: 1,
      y: 0,
      duration: 1.5,
      ease: "power2.out"
    }, "<");
  });
</script>
